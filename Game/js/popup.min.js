var popup_timeout,dismiss_interval,popup={lang:{Cancel:"Cancel",OK:"OK"},init:function(){var b=document.getElementById("popup-out");b||(b=document.createElement("div"),b.setAttribute("id","popup-out"),b.setAttribute("class","popup-base"),document.body.appendChild(b));return b},load:function(){popup.init()},mask:function(b){var a=document.getElementById("popup-out");"show"==b?a.className="popup-base popup-visible":"hidden"==b&&(a.className=" ")},build:function(b,a){popup.init();var e="";"prompt"==
a.type&&(e='<div class="dialog-prompt"><input id="dialog-input" type="text" /></div>');var d="";if("signal"!=a.type&&"async"!=a.type&&"loading"!=a.type){d='<div class="dialog-buttons">';"alert"==a.type&&(d+='<button id="alert-ok">'+popup.lang.OK+"</button>");if("prompt"==a.type||"confirm"==a.type)d+='<button id="'+a.type+'-cancel" class="cancel">'+popup.lang.Cancel+"</button>",d+='<button id="'+a.type+'-ok">'+popup.lang.OK+"</button>";d+="</div>"}var c;c='<div id="popup-bg"></div><div class="dialog popup" id="dialog-popup" >';
var f="";a.hasOwnProperty("compact")&&a.compact||(f='<span id="popup-close" class="popup-close"></span>');var k="";a.hasOwnProperty("indicator")&&a.indicator&&(k='<div id="dismiss-indicator" align="center" style="display: none;"></div>');c=c+f+'<div class="dialog-inner">';c+='<div id="dialog-content" class="dialog-content">'+b+e+k+"</div>";c+=d+"</div></div>";popup_timeout&&clearTimeout(popup_timeout);e=document.getElementById("popup-out");e.innerHTML=c;popup.set_pos();e.className="popup-base popup-visible";
document.getElementById("popup-close")&&document.getElementById("popup-close").addEventListener("click",function(){popup.destroy(a.type);("prompt"==a.type||"confirm"==a.type||"signal"==a.type)&&a.callback&&a.callback(!1)},!1);if(!a.hasOwnProperty("insist")||!a.insist){var l=document.getElementById("popup-bg");l.addEventListener("click",function(){popup.destroy(a.type);("prompt"==a.type||"confirm"==a.type||"signal"==a.type)&&a.callback&&a.callback(!1)},!1)}"alert"==a.type&&(l.addEventListener("click",
function(){a.callback()},!1),c=document.getElementById("alert-ok"),c.addEventListener("click",function(){popup.destroy(a.type);a.callback()},!1),document.onkeyup=function(b){if(13==b.keyCode||32==b.keyCode)popup.destroy(a.type),a.callback()});"confirm"==a.type&&(c=document.getElementById("confirm-cancel"),c.addEventListener("click",function(){popup.destroy(a.type);a.callback(!1)},!1),c=document.getElementById("confirm-ok"),c.addEventListener("click",function(){popup.destroy(a.type);a.callback(!0)},
!1),document.onkeyup=function(b){if(13==b.keyCode||32==b.keyCode)popup.destroy(a.type),a.callback(!0)});if("prompt"==a.type){var m=document.getElementById("dialog-input");setTimeout(function(){m.focus();m.select()},100);c=document.getElementById("prompt-cancel");c.addEventListener("click",function(){popup.destroy(a.type);a.callback(!1)},!1);var n=document.getElementById("dialog-input");c=document.getElementById("prompt-ok");c.addEventListener("click",function(){popup.destroy(a.type);a.callback(n.value)},
!1);document.onkeyup=function(b){13==b.keyCode&&(popup.destroy(a.type),a.callback(n.value))}}"signal"==a.type&&0!=a.timeout&&(document.getElementById("dismiss-indicator")&&(document.getElementById("dismiss-indicator").style.display="",dismiss_interval=setInterval(function(){document.getElementById("dismiss-indicator").innerHTML+="âœ¾&nbsp&nbsp"},1E3)),popup_timeout=setTimeout(function(){popup.destroy(a.type);a.callback&&a.callback()},a.timeout));"async"==a.type&&ajax({url:a.url,data:{lxt:sid},format:"html",
method:"GET",before:null,callback:function(a){document.getElementById("dialog-content").innerHTML=a;popup.set_pos()}})},destroy:function(b){dismiss_interval&&clearInterval(dismiss_interval);var a=document.getElementById("popup-out");a.innerHTML="";a.setAttribute("class","popup-base");if(g=document.getElementById(b+"-ok"))g.removeEventListener("click",function(){},!1),document.onkeyup=null;(h=document.getElementById(b+"-cancel"))&&h.removeEventListener("click",function(){},!1)},set_pos:function(){var b=
document.getElementById("dialog-popup"),a=0<=parseInt((window.innerHeight-b.clientHeight)/2)?parseInt((window.innerHeight-b.clientHeight)/2):5;b.style.top=document.body.scrollTop+a+"px";b.style.left=parseInt(document.body.clientWidth)/2-parseInt(b.scrollWidth)/2+document.body.scrollLeft+5+"px"},alert:function(b,a){"undefined"==typeof a&&(a=function(){});popup.build(b,{type:"alert",callback:a})},signal:function(b,a,e,d,c,f){"undefined"==typeof a&&(a=5E3);popup.build(b,{type:"signal",timeout:a,insist:"undefined"==
typeof d?!1:d,compact:"undefined"==typeof c?!1:c,indicator:"undefined"==typeof f?!1:f,callback:e})},confirm:function(b,a){popup.build(b,{type:"confirm",callback:a})},prompt:function(b,a){return popup.build(b,{type:"prompt",callback:a})},async:function(b){var a=document.getElementById("dialog-content"),a=a?"<div class='popup-loading' style='width: "+(a.clientWidth-20)+"px;'>":"<div class='popup-loading'>",a=a+"<img src='/static/img/loading.gif' /></div>";return popup.build(a,{type:"async",url:b})},
loading:function(b){var a;a="<div class='popup-loading'><img src='/static/img/loading.gif' /></div>";return popup.build(a,{type:"loading",url:b})}};
