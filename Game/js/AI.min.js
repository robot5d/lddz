AI={findBestPokers:function(a,b,e,c){this.analyzePlayerPokers(a);if(!b)return this.freeFindPokers(a);a=this.findAllByType(a,b,e,c);for(c=a.length-1;0<=c;c--){var d=a[c];d instanceof Array||(d=[d]);if(d.length==b.numPokers||Rule.compare(d,e))return d}return null},freeFindPokers:function(a){var b=[],e=a.pokers,c=e.length;if(0==c)return null;if(Rule.getType(e)&&0==a.twoking.length&&0==a.bomb.length)return e;c=a.triple.length;5<=c&&(b=this.findAllByType(a,GroupType.\u4e94\u8fde\u98de\u673a\u5e26\u7fc5\u8180));
4<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u56db\u8fde\u98de\u673a\u5e26\u56db\u5bf9));4<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u56db\u8fde\u98de\u673a\u5e26\u7fc5\u8180));3<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e09\u8fde\u98de\u673a\u5e26\u4e09\u5bf9));3<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e09\u8fde\u98de\u673a\u5e26\u7fc5\u8180));2<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u98de\u673a\u5e26\u4e8c\u5bf9));2<=c&&!b.length&&(b=this.findAllByType(a,
GroupType.\u98de\u673a\u5e26\u7fc5\u8180));5<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e94\u8fde\u98de\u673a));4<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u56db\u8fde\u98de\u673a));3<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e09\u8fde\u98de\u673a));2<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e8c\u8fde\u98de\u673a));if(b.length)return b=b[b.length-1];c=a.triple.length+a.pair.length;10<=c&&(b=this.findAllByType(a,GroupType.\u5341\u8fde\u5bf9));9<=c&&!b.length&&
(b=this.findAllByType(a,GroupType.\u4e5d\u8fde\u5bf9));8<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u516b\u8fde\u5bf9));7<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e03\u8fde\u5bf9));6<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u516d\u8fde\u5bf9));5<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e94\u8fde\u5bf9));4<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u56db\u8fde\u5bf9));3<=c&&!b.length&&(b=this.findAllByType(a,GroupType.\u4e09\u8fde\u5bf9));if(b.length)return b=
b[b.length-1];b=this.findAllByType(a,GroupType.\u5341\u4e8c\u5f20\u987a\u5b50);b.length||(b=this.findAllByType(a,GroupType.\u5341\u4e00\u5f20\u987a\u5b50));b.length||(b=this.findAllByType(a,GroupType.\u5341\u5f20\u987a\u5b50));b.length||(b=this.findAllByType(a,GroupType.\u4e5d\u5f20\u987a\u5b50));b.length||(b=this.findAllByType(a,GroupType.\u516b\u5f20\u987a\u5b50));b.length||(b=this.findAllByType(a,GroupType.\u4e03\u5f20\u987a\u5b50));b.length||(b=this.findAllByType(a,GroupType.\u516d\u5f20\u987a\u5b50));
b.length||(b=this.findAllByType(a,GroupType.\u4e94\u5f20\u987a\u5b50));return b.length?b=b[b.length-1]:(b=this.findSmallestType(a,e))?b:(c=a.bomb.length)?a.bomb[c-1]:(c=a.twoking.length)?a.twoking[0]:null},findSmallestType:function(a,b){var e=b.length,c=b[e-1];if(0==e)return null;if(1==e||1<e&&b[e-2].point!=c.point&&(16!=c.point||17!=b[e-2].point))return c;if(2<=e&&b[e-2].point==c.point&&(2==e||b[e-3].point!=c.point))return[b[e-2],c];if(3<=e&&b[e-2].point==c.point&&b[e-3].point==c.point&&(3==e||b[e-
4].point!=c.point)){var e=[b[e-3],b[e-2],c],c=this.findPlusPoker(a,e,1,!1),d=this.findPlusPoker(a,e,2,!0),k=c&&c.length==e.length+1?c[c.length-1].point:15,f=d&&d.length==e.length+2?d[d.length-1].point:15;return 14<=k&&14<=f?e:f<=k?d:c}return this.findSmallestType(a,b.slice(0,e-4))},findAllByType:function(a,b,e,c){var d=[];if(b==GroupType.\u53cc\u738b)return a.twoking;if(b==GroupType.\u70b8\u5f39)d=a.bomb;else if(b==GroupType.\u5355\u5f20)d=d.concat(a.single),this._slicePokerFromList(a.pair,d,1),this._slicePokerFromList(a.triple,
d,1);else if(b==GroupType.\u5bf9\u5b50)d=d.concat(a.pair),this._slicePokerFromList(a.triple,d,2);else if(b==GroupType.\u4e09\u5f20)d=d.concat(a.triple);else switch(b){case GroupType.\u4e09\u5e26\u4e00:d=this.findTarget(a,3,1,1);break;case GroupType.\u4e09\u5e26\u4e8c:d=this.findTarget(a,3,1,2);break;case GroupType.\u56db\u5e26\u4e8c:d=this.findTarget(a,4,1,2);break;case GroupType.\u56db\u5e26\u4e8c\u5bf9:d=this.findTarget(a,4,1,4);break;case GroupType.\u4e09\u8fde\u5bf9:case GroupType.\u56db\u8fde\u5bf9:case GroupType.\u4e94\u8fde\u5bf9:case GroupType.\u516d\u8fde\u5bf9:case GroupType.\u4e03\u8fde\u5bf9:case GroupType.\u516b\u8fde\u5bf9:case GroupType.\u4e5d\u8fde\u5bf9:case GroupType.\u5341\u8fde\u5bf9:d=
this.findTarget(a,2,b.numPokers/2,0);break;case GroupType.\u4e8c\u8fde\u98de\u673a:case GroupType.\u4e09\u8fde\u98de\u673a:case GroupType.\u56db\u8fde\u98de\u673a:case GroupType.\u4e94\u8fde\u98de\u673a:case GroupType.\u516d\u8fde\u98de\u673a:d=this.findTarget(a,3,b.numPokers/3,0);break;case GroupType.\u98de\u673a\u5e26\u7fc5\u8180:d=this.findTarget(a,3,2,2);break;case GroupType.\u98de\u673a\u5e26\u4e8c\u5bf9:d=this.findTarget(a,3,2,4);break;case GroupType.\u4e09\u8fde\u98de\u673a\u5e26\u7fc5\u8180:d=
this.findTarget(a,3,3,3);break;case GroupType.\u4e09\u8fde\u98de\u673a\u5e26\u4e09\u5bf9:d=this.findTarget(a,3,3,6);break;case GroupType.\u56db\u8fde\u98de\u673a\u5e26\u7fc5\u8180:d=this.findTarget(a,3,4,4);break;case GroupType.\u56db\u8fde\u98de\u673a\u5e26\u56db\u5bf9:d=this.findTarget(a,3,4,8);break;case GroupType.\u4e94\u8fde\u98de\u673a\u5e26\u7fc5\u8180:d=this.findTarget(a,3,5,5);break;}c&&(d=a.twoking.concat(a.bomb,d));if(e)for(a=0;a<d.length;a++)b=
d[a],b instanceof Array||(b=[b]),Rule.compare(b,e)||(d.splice(a,1),a--);return d},findTarget:function(a,b,e,c){var d=[];if(1==b){c=[].concat(a.single);this._slicePokerFromList(a.pair,c,1);this._slicePokerFromList(a.triple,c,1);if(5<=e){this.sort1(c);for(h=c.length-e;0<=h;h--){var k=c.slice(h,h+e);a=!0;for(var f=k.length-1;1<=f;f--)if(15==k[f].point||15==k[f-1].point||k[f].point!=k[f-1].point-1){a=!1;break}a&&d.unshift(k)}return d}return c}d=d.concat(2==b?a.pair:3==b?a.triple:4==b?a.bomb:[]);if(2==
b&&0<a.triple.length)for(var h=0;h<a.triple.length;h++){var g=a.triple[h];d.push([g[0],g[1]])}this.sort3(d);if(1<e){d.length<e&&(d.length=0);k=[];for(h=0;h<d.length&&!(h+e-1>=d.length);h++){g=!0;for(f=1;f<e;f++)if(d[h+f-1][0].point!=d[h+f][0].point+1||15<=d[h+f-1][0].point){g=!1;break}if(g){g=d[h];for(f=1;f<e;f++)g=g.concat(d[h+f]);k.push(g)}}d=k}if(0<c)for(e=3==b?2==c/e:c==b,h=0;h<d.length;h++)(k=this.findPlusPoker(a,d[h],c,e))?d[h]=k:(d.splice(h,1),h++);return d},findPlusPoker:function(a,b,e,c){var d=
[];c?(this._slicePokerFromList(a.triple,d,2),d=d.concat(a.pair)):d=d.concat(a.triple,a.pair,a.single);d=this._normalizeList(d,b);return d.length>=e?(this.sort1(d),a=d.slice(d.length-e,d.length),b.concat(a)):null},_normalizeList:function(a,b,e){e=e||[];for(var c=0;c<a.length;c++){var d=a[c];d instanceof Array?this._normalizeList(d,b,e):-1==b.indexOf(d)&&e.push(d)}return e},_slicePokerFromList:function(a,b,e){for(var c=a.length-1;0<=c;c--){var d=a[c].slice(0,e);1==e&&(d=d[0]);b.unshift(d)}},analyzePlayerPokers:function(a){var b=
[],e=[],c=[],d=[],k=[],f,h,g=a.pokers,l=g.length;this.sort1(g);2<=l&&17==g[0].point&&16==g[1].point&&(k=[[g[0],g[1]]]);for(f=3;f<l;f++)h=g[f].point,g[f-3].point==h&&g[f-2].point==h&&g[f-1].point==h&&(d.push([g[f-3],g[f-2],g[f-1],g[f]]),f+=3);for(f=2;f<l;f++)h=g[f].point,g[f-2].point!=h||g[f-1].point!=h||3<=f&&g[f-3].point==h||f<l-1&&g[f+1].point==h||(c.push([g[f-2],g[f-1],g[f]]),f+=2);for(f=1;f<l;f++)h=g[f].point,g[f-1].point!=h||2<=f&&g[f-2].point==h||f<l-1&&g[f+1].point==h||(e.push([g[f-1],g[f]]),
f++);for(f=0;f<l;f++)h=g[f].point,2<=l&&17==h&&16==g[f+1].point?f++:1<=f&&g[f-1].point==h||f<l-1&&g[f+1].point==h||b.push(g[f]);a.twoking=k;a.bomb=d;a.triple=c;a.single=b;a.pair=e},gamble:function(a){a=this.scorePlayerPokers(a);return 20>a?0:30>=a?1:30<a&&45>=a?2:3},scorePlayerPokers:function(a){this.analyzePlayerPokers(a);var b,e,c=0;for(b=0;b<a.single.length;b++)e=a.single[b].point,17==e?c+=10:16==e?c+=8:10<e&&(c+=e-10);for(b=0;b<a.pair.length;b++)e=a.pair[b][0].point,15==e?c+=10:14==e?c+=8:10<
e&&(c+=1.2*(e-10)*(1+(e-10)/10));for(b=0;b<a.triple.length;b++)e=a.triple[b][0].point,15==e?c+=15:14==e?c+=12:10<e&&(c+=2*(e-10)*(1+(e-10)/10));for(b=0;b<a.bomb.length;b++)e=a.bomb[b][0].point,c=15==e?c+30:14==e?c+24:10<e?c+17*(1+(e-10)/10):c+16;0<a.twoking.length&&(c+=30);return a.pokerScore=Math.round(c)},filterPokers:function(a,b){for(var e=[],c=0;c<a.length;c++){var d=a[c];b instanceof Array?-1==b.indexOf(d)&&e.push(d):b!=d&&e.push(d)}return e},sort1:function(a){a.sort(function(b,a){var c=a.point-
b.point;return 0==c?a.type.rank-b.type.rank:c});return a},sort2:function(a){for(var b={},e=0,c=0;c<a.length;c++){var d=a[c];17!=d.point&&16!=d.point||e++;void 0==b[d.point]?b[d.point]=1:++b[d.point]}a.sort(function(a,c){var d=b[a.point],g=b[c.point];return d==g||2==e&&(17==a.point||16==a.point)?c.point-a.point:g-d});b=null;return a},sort3:function(a){a.sort(function(a,e){return a[0].point<e[0].point})},hasChance:function(a){return Math.round(100*Math.random()+1)<=a?!0:!1}};
